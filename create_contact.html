<!DOCTYPE html>
<html>
<head>
<title>Create Contact</title>
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery-1.8.2.js"></script>
<script type="text/javascript" charset="utf-8" src="jquery.mobile-1.2.0.js"></script>
<script type="text/javascript" charset="utf-8">
// Wait for Cordova to load
//
document.addEventListener("deviceready", onDeviceReady, false);
// Cordova is ready
//
function onDeviceReady() {
// alert("Device ready!");
}

//Save contact
function saveContact( )
{
// Get the data from form
var fname = document.getElementById('firstname').value;
var lname = document.getElementById('lastname').value;
var phoneNumbers = document.getElementById('phoneNumbers').value;
var fullname = fname +" "+lname;

// create a new contact
var contact = navigator.contacts.create();
contact.displayName = fullname;
var name = new ContactName();
name.givenName = fname;
name.familyName = lname;
contact.name = name;
var phoneNums = [1];
phoneNums [0] = new ContactField('mobile', phoneNumbers, true);
contact.phoneNumbers = phoneNums;
// save
contact.save(onSaveSuccess,onSaveError);
}
// onSaveSuccess: Get a snapshot of the current contacts
//
function onSaveSuccess(contact) {
alert("Save Success");
var transport = setTimeout(function(){callPage() {window.location = "contact.html";}},3000);
}
// onSaveError: Failed to get the contacts
//
function onSaveError(contactError) {
alert("Error = " + contactError.code);
}

// Show a custom confirmation dialog
function showConfirm(){
	navigator.notification.confirm(
		'Would you like to take a photo', // message
		onConfirm, // callback to invoke with index of button pressed
		'contact photo', // title
		['Yes','No']    // buttonLabels
		);
		}

function onConfirm(buttonIndex) {
	if (buttonIndex == 0 || buttonIndex == 2){
		//If no button pressed return to search contact
		window.location = "contact.html";
		}
		else {
				//else use localStorage to save contact name and go to next page
				window.location = "camera.html";
			}
		}
		function takePhoto(){
			window.location="camera.html";
		}
</script>
</head>
<body>
<h1>creating a new contact</h1>
<form id="cform">
<label for="firstname" >First name </label><br/>
<input type="text" id="firstname" name="first" /> <br/>
<label for="flastname" >Last name </label><br/>
<input type="text" id = "lastname" /> <br/>
<label for="phonenumber" >Phone Number </label><br/>
<input type="tel" id="phoneNumbers" name="phoneNumbers"/> <br/>
<input type="button" value="Save Contact" id="btnSave" onclick="saveContact()"/>
<input type="button" value="Take Photo" id="smallImage" onclick="takePhoto()"/>
</form>
</body>
